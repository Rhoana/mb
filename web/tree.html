<html>
  <head>
    <title>MBEAM</title>
    <link rel="stylesheet" href="css/jquery-ui.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/jqtree.css">
    

    <script type='text/javascript' src='lib/jquery.min.js'></script>
    <script type='text/javascript' src='lib/jquery-ui.min.js'></script>
    <script type='text/javascript' src='lib/jquery.cookie.min.js'></script>
    <script type='text/javascript' src='lib/tree.jquery.js'></script>
    
    <script type='text/javascript'>

    window.onload = function() {

      var tree = $('#nav').tree({

        // onCreateLi: function(node, $li) {
        //     // Append a link to the jqtree-element div.
        //     // The link has an url '#node-[id]' and a data property 'node-id'.
        //     // console.log(node);
            
        //     $li.find('.jqtree-element').append(
        //         '&nbsp;&nbsp;<a href="?data='+node.full_url+'"><img style="vertical-align:middle" src="gfx/'+node.type+'.gif"></a>'
        //     );
        // }


      });


    tree.bind(
        'tree.click', 
        function(e) {

          var node = e.node;
          var element = e.node.element;

          // if (node.type == "NULL") {


            var r = $.ajax({
              url: 'type/' + node.full_url,
              type: 'GET'
            }).done(function() {

              node.type = r.responseText;
              
              if (element.children[0].children.length == 2) {
                $(element.children[0]).append("&nbsp;&nbsp;<a href='index.html?data="+node.full_url+"'><img style='vertical-align:middle' src='gfx/"+node.type+".gif'></a>");
              }

            });


          // }

        }

      );

  }



    </script>
  </head>
  <body id='body'>
    <div id='nav' data-url='tree//Users/d/Desktop/data/'></div>
  </body>
</html>
